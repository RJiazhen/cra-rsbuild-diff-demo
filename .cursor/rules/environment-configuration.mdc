---
alwaysApply: true
---
# Environment Configuration

This project uses environment-based builds with Rsbuild to manage different build configurations.

## Environment Modes

Build commands use `--env-mode` flags to load different environment configurations:
- Development: `--env-mode rsbuild.X.Y.development`
- Production: `--env-mode rsbuild.X.Y.production`

## Environment Variables

The [rsbuild.config.ts](mdc:rsbuild.config.ts) reads these environment variables:

- `RSBUILD_VERSION` - Determines which Rsbuild version to use (1.4 or 1.5)
- `SOURCE_ENTRY_INDEX` - Optional override for entry point (default: `./src/index.js`)
- `DISABLE_MINIFY` - Set to `true` to disable code minification (default: false)

## Environment Files Pattern

Environment files follow this naming pattern:
- `.env.rsbuild.{version}.{mode}` - Standard builds
- `.env.rsbuild.{version}.{mode}.nominify` - Builds without minification

Examples:
- `.env.rsbuild.1.5.production` - Standard production build
- `.env.rsbuild.1.5.production.nominify` - Production build without minify

These files should contain:
```env
RSBUILD_VERSION=1.5
SOURCE_ENTRY_INDEX=./src/index.js
```

For builds without minification:
```env
RSBUILD_VERSION=1.5
DISABLE_MINIFY=true
```

For alternate entry points without minification:
```env
RSBUILD_VERSION=1.5
SOURCE_ENTRY_INDEX=./src/index-2.js
DISABLE_MINIFY=true
```

## Dynamic Configuration

The config in [rsbuild.config.ts](mdc:rsbuild.config.ts) uses these environment variables to:
1. Determine output directory: `rsbuild-dist-{version}` or `rsbuild-dist-{version}-index-2` or `rsbuild-dist-{version}-nominify` (when `DISABLE_MINIFY=true`)
2. Set the entry point: Source entry index from env or default
3. Control which Rsbuild version instance to use
4. Control minification: `output.minify` is set to `false` when `DISABLE_MINIFY=true`
